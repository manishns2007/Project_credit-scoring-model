
!pip install scikit-learn matplotlib seaborn gradio

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import gradio as gr

from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.linear_model import LogisticRegression
from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import classification_report, confusion_matrix, roc_auc_score, roc_curve


# STEP 1: DATA PREPARATION

np.random.seed(42)
n_samples = 1000

data = pd.DataFrame({
    "income": np.random.normal(50000, 15000, n_samples),
    "debt": np.random.normal(15000, 5000, n_samples),
    "payment_history": np.random.choice([0, 1], size=n_samples, p=[0.3, 0.7]),  
    "age": np.random.randint(21, 65, n_samples),
    "credit_score": np.random.randint(300, 850, n_samples)
})

data["creditworthy"] = (
    (data["income"] / (data["debt"] + 1) > 3) & (data["payment_history"] == 1)
).astype(int)

# Features/target
X = data.drop("creditworthy", axis=1)
y = data["creditworthy"]

# Scale numerical features
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# Train-test split
X_train, X_test, y_train, y_test = train_test_split(
    X_scaled, y, test_size=0.3, random_state=42, stratify=y
)


# STEP 2: MODEL TRAINING

# We’ll keep Random Forest as final model for deployment
model = RandomForestClassifier(n_estimators=100, random_state=42)
model.fit(X_train, y_train)


# STEP 3: EVALUATION

y_pred = model.predict(X_test)
y_prob = model.predict_proba(X_test)[:, 1]

print("Classification Report:\n", classification_report(y_test, y_pred))
print("ROC-AUC:", roc_auc_score(y_test, y_prob))


# STEP 4: GRADIO WEB APP

def predict(income, debt, payment_history, age, credit_score):
    features = np.array([[income, debt, payment_history, age, credit_score]])
    features_scaled = scaler.transform(features)
    prediction = model.predict(features_scaled)[0]
    return "✅ Creditworthy" if prediction == 1 else "❌ Not Creditworthy"

demo = gr.Interface(
    fn=predict,
    inputs=[
        gr.Number(label="Income"),
        gr.Number(label="Debt"),
        gr.Radio([0, 1], label="Payment History (0=Bad, 1=Good)"),
        gr.Number(label="Age"),
        gr.Number(label="Credit Score")
    ],
    outputs="text",
    title="Credit Scoring Model"
)

demo.launch(share=True)  
